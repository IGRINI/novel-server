{{ template "layout.html" . }}

{{ define "title" }}Управление Промптами{{ end }}

{{ define "content" }}
<div class="container mt-4">
    <h2>{{ .title }}</h2>
    <a href="/admin/prompts/new" class="btn btn-primary mb-3">Add New Prompt</a>

    {{/* --- Flash Message Display --- */}}
    {{if .flash}}
    <div class="alert alert-{{if eq .flash.Type "error"}}danger{{else if eq .flash.Type "success"}}success{{else}}info{{end}} alert-dismissible fade show" role="alert">
        {{ .flash.Message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {{end}}
    {{/* --- End Flash Message Display --- */}}

    {{if not .prompts}}
    <div class="alert alert-info">No prompts found.</div>
    {{else}}
    <div class="app-container">
        <nav class="breadcrumbs">
            <ul>
                <li><a href="/admin/dashboard">Дашборд</a></li>
                <li>Управление Промптами</li>
            </ul>
        </nav>

        <h1>Управление Промптами</h1>

        {{ if .SuccessMessage }}
            <div class="system-message system-message--success">{{ .SuccessMessage }}</div>
        {{ end }}
        {{ if .ErrorMessage }}
            <div class="system-message system-message--error">{{ .ErrorMessage }}</div>
        {{ end }}

        <div class="button-group mb-3">
            <a href="/admin/prompts/new" class="cta-button cta-button--success">Создать Ключ Промпта</a>
        </div>

        <table class="data-table">
            <thead>
            <tr>
                <th>Ключ</th>
                <th>Действия</th>
            </tr>
            </thead>
            <tbody>
            {{ range .PromptKeys }}
            <tr>
                <td>{{ . }}</td>
                <td>
                    <div class="button-group" style="justify-content: flex-start;">
                        <a href="/admin/prompts/edit?key={{ . | urlquery }}" class="cta-button cta-button--primary btn-sm">Редактировать</a>
                        <form action="/admin/prompts/delete" method="post" style="display: inline; margin: 0;" onsubmit="return confirm('Вы уверены, что хотите удалить ключ {{ . }} и ВСЕ его языковые версии?');">
                            <input type="hidden" name="key" value="{{ . }}">
                            <button type="submit" class="cta-button cta-button--danger btn-sm">Удалить</button>
                        </form>
                     </div>
                </td>
            </tr>
            {{ else }}
            <tr>
                <td colspan="2" style="text-align: center;">Ключи промптов не найдены.</td>
            </tr>
            {{ end }}
            </tbody>
        </table>
    </div>
    {{ end }}
</div>
{{ end }} 