{{ template "layout.html" . }}

{{ define "title" }}{{ .PageTitle }}{{ end }}

{{ define "content" }}
<div class="container mt-4">
    <h2>{{ .title }}</h2>

    {{/* --- Flash Message Display --- */}}
    {{if .flash}}
    <div class="alert alert-{{if eq .flash.Type "error"}}danger{{else if eq .flash.Type "success"}}success{{else}}info{{end}} alert-dismissible fade show" role="alert">
        {{ .flash.Message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {{end}}
    {{/* --- End Flash Message Display --- */}}

    <form action="{{ .form_action }}" method="POST">
        {{/* Если это редактирование, используем метод PUT (скрытое поле) */}}
        {{if .prompt.ID}}
        <input type="hidden" name="_method" value="PUT"> {{/* Gin не поддерживает это из коробки, может потребоваться middleware или адаптация роутинга */}}
        {{end}}

        <div class="mb-3">
            <label for="key" class="form-label">Prompt Key</label>
            <input type="text" class="form-control" id="key" name="Key" value="{{ .prompt.Key }}" {{if .prompt.ID}}readonly{{end}} required>
            {{if .prompt.ID}}<small class="form-text text-muted">Key cannot be changed after creation.</small>{{end}}
        </div>

        <div class="mb-3">
            <label for="language" class="form-label">Language</label>
            <select class="form-select" id="language" name="Language" {{if .prompt.ID}}disabled{{end}} required>
                <option value="" {{if not .prompt.Language}}selected{{end}}>Select Language</option>
                {{range .languages}}
                <option value="{{ . }}" {{if eq . $.prompt.Language}}selected{{end}}>{{ . }}</option>
                {{end}}
            </select>
             {{if .prompt.ID}}<input type="hidden" name="Language" value="{{ .prompt.Language }}"> <small class="form-text text-muted">Language cannot be changed after creation.</small>{{end}}
        </div>

        <div class="mb-3">
            <label for="content" class="form-label">Prompt Content</label>
            <textarea class="form-control" id="content" name="Content" rows="10" required>{{ .prompt.Content }}</textarea>
        </div>

        <button type="submit" class="btn btn-success">Save Prompt</button>
        <a href="/admin/prompts" class="btn btn-secondary">Cancel</a>
    </form>

</div>

{{end}} 